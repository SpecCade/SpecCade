{
  "spec_version": 1,
  "asset_id": "compose_harmony_octave_bass_4bars",
  "asset_type": "music",
  "license": "CC0-1.0",
  "seed": 1234,
  "description": "Draft compose-v1 example (RFC-0004): aliases + bars/beats + chord-tone bass + octave doubling",
  "outputs": [{ "kind": "primary", "format": "xm", "path": "compose_harmony_octave_bass_4bars.xm" }],
  "recipe": {
    "kind": "music.tracker_song_compose_v1",
    "params": {
      "format": "xm",
      "bpm": 150,
      "speed": 6,
      "channels": 8,
      "loop": false,

      "timebase": { "beats_per_bar": 4, "rows_per_beat": 4 },
      "channel_ids": { "kick": 0, "snare": 1, "bass_lo": 2, "bass_hi": 3, "lead": 4, "hats": 5 },
      "instrument_ids": { "kick": 0, "snare": 1, "hat": 2, "bass": 3, "lead": 4 },

      "harmony": {
        "key": { "root": "A", "scale": "minor" },
        "chords": [
          { "at": { "bar": 0 }, "chord": { "symbol": "Am" } },
          { "at": { "bar": 1 }, "chord": { "symbol": "F" } },
          { "at": { "bar": 2 }, "chord": { "symbol": "G" } },
          { "at": { "bar": 3 }, "chord": { "symbol": "E7" } }
        ]
      },

      "instruments": [
        { "name": "kick", "base_note": "C4", "synthesis": { "type": "sine" } },
        { "name": "snare", "base_note": "D4", "synthesis": { "type": "noise", "periodic": false } },
        { "name": "hat", "base_note": "C1", "synthesis": { "type": "noise", "periodic": true } },
        { "name": "bass", "base_note": "C2", "synthesis": { "type": "sawtooth" } },
        { "name": "lead", "base_note": "C5", "synthesis": { "type": "sawtooth" } }
      ],

      "defs": {
        "kick_4": {
          "op": "emit",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 0, "sub": 0 },
            "step": { "beats": 1, "sub": 0 },
            "count": 16
          },
          "cell": { "channel": "kick", "inst": "kick", "note": "C4", "vol": 64 }
        },
        "snare_2_4": {
          "op": "emit",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 1, "sub": 0 },
            "step": { "beats": 2, "sub": 0 },
            "count": 8
          },
          "cell": { "channel": "snare", "inst": "snare", "note": "D4", "vol": 56 }
        },
        "hats_16": {
          "op": "emit",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 0, "sub": 0 },
            "step": { "beats": 0, "sub": 1 },
            "count": 64
          },
          "cell": { "channel": "hats", "inst": "hat", "note": "C1", "vol": 28 }
        },

        "bass_chord_tones_lo": {
          "op": "emit_seq",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 0, "sub": 0 },
            "step": { "beats": 0, "sub": 2 },
            "count": 32
          },
          "cell": { "channel": "bass_lo", "inst": "bass", "vol": 56 },
          "pitch_seq": {
            "kind": "chord_tone",
            "mode": "cycle",
            "values": ["1", "5", "1", "5"],
            "octave": 2
          }
        },
        "bass_chord_tones_hi": {
          "op": "emit_seq",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 0, "sub": 0 },
            "step": { "beats": 0, "sub": 2 },
            "count": 32
          },
          "cell": { "channel": "bass_hi", "inst": "bass", "vol": 40 },
          "pitch_seq": {
            "kind": "chord_tone",
            "mode": "cycle",
            "values": ["1", "5", "1", "5"],
            "octave": 3
          }
        },

        "lead_degrees": {
          "op": "emit_seq",
          "at": {
            "op": "beat_range",
            "start": { "bar": 0, "beat": 0, "sub": 0 },
            "step": { "beats": 0, "sub": 2 },
            "count": 32
          },
          "cell": { "channel": "lead", "inst": "lead", "vol": 44 },
          "pitch_seq": {
            "kind": "scale_degree",
            "mode": "cycle",
            "values": ["1", "2", "3", "5", "5", "3", "2", "1"],
            "octave": 5
          }
        }
      },

      "patterns": {
        "verse_4bars": {
          "bars": 4,
          "program": {
            "op": "stack",
            "merge": "error",
            "parts": [
              { "op": "ref", "name": "kick_4" },
              { "op": "ref", "name": "snare_2_4" },
              { "op": "ref", "name": "hats_16" },
              { "op": "ref", "name": "bass_chord_tones_lo" },
              { "op": "ref", "name": "bass_chord_tones_hi" },
              { "op": "ref", "name": "lead_degrees" }
            ]
          }
        }
      },
      "arrangement": [{ "pattern": "verse_4bars", "repeat": 1 }]
    }
  }
}

